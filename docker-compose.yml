version: '3'
services:
  influxdb:
    image: influxdb:latest
    container_name: influxdb
    ports:
      - "8086:8086"
    volumes:
      - mydata:/var/lib/influxdb  # Use the 'mydata' volume for InfluxDB data
    environment:
      - INFLUXDB_DB=mydb
      - INFLUXDB_ADMIN_USER=myuser
      - INFLUXDB_ADMIN_PASSWORD=mypassword
      - INFLUXDB_HTTP_AUTH_ENABLED=true

  nodeapp:
    build:
      context: ./app  # Path to your Node.js app's directory
      dockerfile: Dockerfile  # Specify the Dockerfile to use
    container_name: cg-test
    image: cosmic-glimpse  # Explicitly specify the image name
    ports:
      - "3000:3000"
    environment:
      - INFLUXDB_HOST=influxdb
      - INFLUXDB_PORT=8086
    depends_on:
      - influxdb

volumes:
  mydata:  # Define the 'mydata' Docker volume
